---
title: "Data Visualization"
author: "Rachel Fellman"
date: "2024-07-24"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(caret)
library(modeldata)
```

Clean data
```{r}
data("hotel_rates")

#change certain rows to factors
myhotel<- hotel_rates %>% 
  mutate(is_repeated_guest = as.factor(is_repeated_guest), previous_cancellations,
         near_christmas = as.factor(near_christmas),
         near_new_years = as.factor(near_new_years)) %>% 
  #take out historical_adr variable since it is not part of the original data
  select(-"historical_adr")

```

# Data visualization


ggplot(myhotel) aes(x = lead_time, y = avg_price_per_room)) + 
  geom_point(aes(color = as.factor(is_repeated_guest)))+
  scale_fill_discrete(name = "Is Repeated Guest?", labels = c("No","Yes"))

# plot 1

Scatter plot of `avg_price_per_room` vs `lead_time` (Number of days that elapsed between the entering date of the booking into the PMS and the arrival date) colored by `customer_type`.
```{r}
#make base plot
g<- ggplot(myhotel, aes(x = lead_time, y = avg_price_per_room))
#add layers
g+ geom_point(aes(color = customer_type))+
  labs(x = "lead time (days)", y = "Average Room Price (euros)")
  

```

This is a scatter plot of average room rate in euros compared to the number of days between entering the date of booking into the system and the guest's arrival date. The points are colored by customer type. It appears that the majority of bookings are transient meaning they are not associated with a group or contract. From this plot we can see that there is a slightly negative relationship between lead time and room rate.


## plot 2
bar graph of `room_type` colored by `market_segment`
```{r}
#define base plot
g<- ggplot(myhotel, aes(x = reserved_room_type))
 g+ geom_bar(aes(fill= market_segment))+
  labs(x = "Room type")
```
There appears to be a much higher count of room type a than any of the other room types. Due to the necessity of anonymity, we do not have access to what room type a is. From this graph, it also seems that the majority of all room types are from online travel agents.


## plot 3


Boxplot of `stays_in_week_nights` by `meal`

```{r}
g <- ggplot(myhotel, aes(x = meal, y = stays_in_week_nights))
g + geom_boxplot(fill = "blue")
```

From these boxplots we can see there is little difference in the median length of stay for weeknight guests among the different meal packages. The distributions among the boxplots look similar. However, there are clearly a few outliers for the bed_and_breakfast and the bed_and_breakfast_and_one_other_meal categories, so those two distributions may be slightly right skewed.




























