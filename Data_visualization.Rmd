---
title: "Data Visualization"
author: "Rachel Fellman"
date: "2024-07-24"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
```

Read in the data:
I will be saving our data in a data frame named patients.
```{r}
patients <- read.csv("dataset.csv")
patients
```

# Data visualization

##  plot 1:
First filter data to remove negative 1 probabilites which are representing missing values.
```{r}
patients2 <- gsub(-1, NA , patients$apache_4a_icu_death_prob )
patients$apache_4a_icu_death_prob = patients2

```


```{r}
patients3 <- patients %>% 
  drop_na(apache_4a_icu_death_prob)
```

Scatterplot of age vs apache_4a_hospital_death_prob colored by gender
```{r}
ggplot(patients3, aes(x = age, y = apache_4a_icu_death_prob)) + geom_jitter(aes(color = as.factor(gender)))+
  scale_y_discrete(
    breaks = seq(0, 1, by = 0.1)  # Adjust the breaks on the y-axis
  )
```

This plots a scatter plot of patient age against the apache IV ICU death probability colored by gender. There appears to be a random scatter of genders. There are however more older people with higher scores than younger people. This could be because older people are more prone to disease or are more likely to have a weakened immune system, or it could be because there are more older people who are admitted to the hospital.


## plot 2

histogram of  maximum diastolic blood pressure the first 24 hours of their unit stay.
```{r}
ggplot(patients, aes(x = d1_diasbp_max)) + geom_histogram(fill = "blue") +
  xlab("maximum diastolic blood pressure")
```
The distribution of max blood pressures appears to be relatively normal.


## plot 3

patient ethnicity vs hospital death
```{r}
table(patients$ethnicity, patients$hospital_death)
```

plot ethnicity vs hospital death

```{r}
ggplot(patients, aes(x=ethnicity)) + geom_bar(aes(fill = as.factor(hospital_death)), position = "fill")
```
Although we already looked at a bar graph of ethnicity, here we can see the percent of deaths by ethnicity. When it is all standardized there appears to be little difference in the percent of hospital deaths from one ethnicity to another. We could interpret this as there being few differences in hospital care between race (which is a good thing), however there are many other factors to consider before making a conclusion.


## plot 4
diabetes vs age


```{r}
ggplot(patients, aes(x = age)) +geom_density(adjust = 0.5, alpha = 0.5, aes(fill = as.factor(diabetes_mellitus)))
```

This shows the smoothed distribution of age for patients with and without diabetes. Age appears to be left skewed for patients with an without diabetes. We can see that between about ages 65 and 75 there is a higher density of patients with diabetes than without. 
